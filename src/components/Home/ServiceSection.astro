---
import Service from "../Shared/ServiceCarousel.astro";
import contentfulClient from "#lib/contentfulClient";

export async function getStaticPaths({ paginate }) {
  const entries = await contentfulClient.getEntries({
    content_type: "service",
  });

  // Extract the items from entries
  const services = entries.items;

  // Return paginated data with proper structure
  return paginate(services, {
    pageSize: 12,
    props: { services }, // Pass additional props if needed
  });
}

// Destructure the page prop correctly
const { page } = Astro.props;

// Make sure page.data exists before duplicating
const services = page?.data || [];
const duplicatedServices = [...services, ...services];
---

<section class="container mx-auto px-4 py-20 md:py-24 overflow-hidden">
  <h2
    class="text-center text-3xl md:text-5xl font-bold uppercase mb-12 md:mb-20 font-lemonmilk"
  >
    Services
  </h2>
  <div class="relative min-w-[1500px] mx-auto overflow-hidden">
    <ul class="flex min-w-full whitespace-nowrap animate-scroll">
      {
        duplicatedServices.map((service, index) => (
          <li key={index} class="flex-shrink-0 px-4">
            <Service title={service.fields.title} href={service.fields.slug} />
          </li>
        ))
      }
    </ul>
  </div>
</section>

<style>
  @keyframes scroll {
    from {
      transform: translateX(0);
    }
    to {
      transform: translateX(-50%);
    }
  }
  .animate-scroll {
    display: flex;
    width: max-content;
    animation: scroll 60s linear infinite;
  }
</style>
