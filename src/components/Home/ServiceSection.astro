---
import Service from "../Shared/ServiceCarousel.astro";
import contentfulClient from "#lib/contentfulClient";

export async function getStaticPaths({ paginate }: any) {
  const entries = await contentfulClient.getEntries({
    content_type: "service",
  });

  const services = entries.items as any;

  return paginate(services, {
    pageSize: 12,
  });
}

const { page } = Astro.props as any;

const duplicatedServices = [...services, ...services]; // Duplicate services for seamless effect
---

<section class="container mx-auto px-4 py-20 md:py-24 overflow-hidden">
  <h2
    class="text-center text-3xl md:text-5xl font-bold uppercase mb-12 md:mb-20 font-lemonmilk"
  >
    Services
  </h2>

  <!-- Carousel Container -->
  <div class="relative min-w-[1500px] mx-auto overflow-hidden">
    <!-- Carousel Track -->
    <ul class="flex min-w-full whitespace-warp animate-scroll">
      {
        duplicatedServices.map((service, index) => (
          <li class="flex-shrink-0 px-4">
            {page.data.map((o) => (
              <Service
                key={index}
                title={o.fields.title}
                href={o.fields.slug}
              />
            ))}
          </li>
        ))
      }
    </ul>
  </div>
</section>

<!-- Tailwind & Keyframes for Smooth Infinite Scrolling -->
<style>
  @keyframes scroll {
    from {
      transform: translateX(0);
    }
    to {
      transform: translateX(-50%);
    }
  }

  .animate-scroll {
    display: flex;
    width: max-content;
    animation: scroll 60s linear infinite;
  }
</style>

